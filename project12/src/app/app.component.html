<div class="container">
  <h1>Lista de Usu√°rios</h1>
  
  <!-- Action Buttons -->
  <div class="action-buttons">
    <button (click)="createNewUser()" class="btn btn-primary">
      ‚ûï Novo Usu√°rio
    </button>
  </div>
  
  <!-- Search Filter -->
  <div *ngIf="!loading && !error" class="search-container">
    <div class="search-box">
      <input 
        type="text" 
        [(ngModel)]="searchTerm" 
        placeholder="Buscar por nome, username ou email..."
        class="search-input"
      >
      <div class="search-icon">üîç</div>
    </div>
    <div class="search-info" *ngIf="searchTerm">
      <span>{{ (users | filterByName:searchTerm).length }} usu√°rio(s) encontrado(s)</span>
    </div>
  </div>
  
  <!-- Loading State -->
  <div *ngIf="loading" class="loading">
    <div class="spinner"></div>
    <p>Carregando usu√°rios...</p>
  </div>
  
  <!-- Error State -->
  <div *ngIf="error" class="error">
    <p>{{ error }}</p>
    <button (click)="loadUsers()">Tentar novamente</button>
  </div>
  
  <!-- Users List -->
  <div *ngIf="!loading && !error" class="users-grid">
    <div *ngFor="let user of users | filterByName:searchTerm" class="user-card">
      <div class="user-header">
        <h3>{{ user.name }}</h3>
        <span class="username">{{ '@' + user.username }}</span>
      </div>
      
      <div class="user-info">
        <div class="info-item">
          <strong>Email:</strong>
          <a [href]="'mailto:' + user.email">{{ user.email }}</a>
        </div>
        
        <div class="info-item">
          <strong>Telefone:</strong>
          <span>{{ user.phone }}</span>
        </div>
        
        <div class="info-item">
          <strong>Website:</strong>
          <a [href]="'http://' + user.website" target="_blank">{{ user.website }}</a>
        </div>
      </div>
      
      <div class="address-section">
        <h4>Endere√ßo</h4>
        <p>{{ user.address.street }}, {{ user.address.suite }}</p>
        <p>{{ user.address.city }}, {{ user.address.zipcode }}</p>
        <small>Coordenadas: {{ user.address.geo.lat }}, {{ user.address.geo.lng }}</small>
      </div>
      
      <div class="company-section">
        <h4>Empresa</h4>
        <p><strong>{{ user.company.name }}</strong></p>
        <p class="catchphrase">&quot;{{ user.company.catchPhrase }}&quot;</p>
        <small>{{ user.company.bs }}</small>
      </div>
      
      <!-- Action Buttons -->
      <div class="user-actions">
        <button (click)="editUser(user)" class="btn btn-edit">
          ‚úèÔ∏è Editar
        </button>
        <button (click)="deleteUser(user)" class="btn btn-delete">
          üóëÔ∏è Excluir
        </button>
      </div>
    </div>
  </div>
  
  <!-- Edit/Create Form Modal -->
  <div *ngIf="isEditing || isCreating" class="modal-overlay" (click)="cancelEdit()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>{{ isCreating ? 'Novo Usu√°rio' : 'Editar Usu√°rio' }}</h3>
        <button (click)="cancelEdit()" class="close-btn">&times;</button>
      </div>
      
      <form #userForm="ngForm" (ngSubmit)="saveUser(userForm)" class="user-form">
        <div class="form-row">
          <div class="form-group">
            <label for="name">Nome *</label>
            <input 
              type="text" 
              id="name" 
              name="name"
              [(ngModel)]="editingUser!.name"
              #name="ngModel"
              required
              minlength="2"
              class="form-control"
            >
            <div *ngIf="name.invalid && name.touched" class="error-message">
              Nome √© obrigat√≥rio (m√≠nimo 2 caracteres)
            </div>
          </div>
          
          <div class="form-group">
            <label for="username">Username *</label>
            <input 
              type="text" 
              id="username" 
              name="username"
              [(ngModel)]="editingUser!.username"
              #username="ngModel"
              required
              minlength="2"
              class="form-control"
            >
            <div *ngIf="username.invalid && username.touched" class="error-message">
              Username √© obrigat√≥rio (m√≠nimo 2 caracteres)
            </div>
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="email">Email *</label>
            <input 
              type="email" 
              id="email" 
              name="email"
              [(ngModel)]="editingUser!.email"
              #email="ngModel"
              required
              email
              class="form-control"
            >
            <div *ngIf="email.invalid && email.touched" class="error-message">
              Email v√°lido √© obrigat√≥rio
            </div>
          </div>
          
          <div class="form-group">
            <label for="phone">Telefone</label>
            <input 
              type="tel" 
              id="phone" 
              name="phone"
              [(ngModel)]="editingUser!.phone"
              class="form-control"
            >
          </div>
        </div>
        
        <div class="form-group">
          <label for="website">Website</label>
          <input 
            type="url" 
            id="website" 
            name="website"
              [(ngModel)]="editingUser!.website"
            class="form-control"
          >
        </div>
        
        <div class="form-actions">
          <button 
            type="submit" 
            [disabled]="userForm.invalid"
            class="btn btn-save"
          >
            {{ isCreating ? 'Criar Usu√°rio' : 'Salvar Altera√ß√µes' }}
          </button>
          <button 
            type="button" 
            (click)="cancelEdit()"
            class="btn btn-cancel"
          >
            Cancelar
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
